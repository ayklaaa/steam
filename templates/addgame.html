{% extends "base.html" %}

{% block main %}
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;

            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            padding: 20px;
        }
.btn{
    border-radius: 0;
}
        select-wrapper {
            width: 100%;
            background-color: #2c2c2c;
            color: white;
                border: 1px;
    padding: 7px;
        }

        .selection   ul,  button{
            border: 1px solid #222222;

    padding: 0;

            margin: 0;
        }
        .selection{

        }
 .selection span{
     background-color: #2c2c2c;
         margin: 0;
      border: none;
 }
 .selection li:focus{
      background-color: #222222;
     color: white;
 }
 .select2-container--open .select2-dropdown--below {
      background-color: #2c2c2c;
 }
 .select2-container .select2-selection--single .select2-selection__rendered {
     overflow: visible;
     color: white;
 }
 .select2-container--default .select2-results__option--selected {
     background-color: #2c2c2c;
     color: white;
 }
 .select2-container--default .select2-results__option--highlighted.select2-results__option--selectable {
     background-color: #1c7430;
 }
        .container {
            width: 100%;
            max-width: 690px;
            height: max-content;
            display: flex;
            background-color: #1e1e1e;
            margin-top: 1100px;
            margin-bottom: 100px;
            flex-direction: column;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }


        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
        }

        input, textarea {
            width: 100%;
            border: 1px solid #333;
            background-color: #2c2c2c;
            color: #e0e0e0;

        }

        .container input {
            padding: 5px 10px;
        }

        input:focus, textarea:focus {
            border-color: #4CAF50;
            outline: none;
        }
h3{
    margin-top: 15px;
}
.select2-container--default .select2-selection--multiple {
    background-color: #2c2c2c;
    color: white;
    font-family: "Segoe UI", system-ui, sans-serif;
}

.select2-container--default .select2-selection--multiple .select2-selection__choice__remove {

    background-color: #2c2c2c;
}
.select2-container--default .select2-selection--multiple .select2-selection__choice {
    background-color: #2c2c2c;
    border: 1px solid #2c2c2c;

}
.select2-container--default .select2-selection--multiple .select2-selection__choice__display{
    font-family: "Audiowide", sans-serif;
}
.select2-container--default .select2-search--inline .select2-search__field {
    font-family: 'Consolas', 'Menlo', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;
}
.select2-container--default .select2-selection--multiple {

    border: 1px solid #222222;
    border-radius: 4px;
    cursor: text;
    padding-bottom: 5px;
    padding-right: 5px;
    position: relative;
}
.form-control {
    background-color: #2c2c2c;
    border: 0
;
    color:white ;

}
.form-control:focus {
    background-color: #2c2c2c;
    border: 0
;
    color:white ;

}
.form-control li:focus{
    background-color: #1c7430;
    border: 0
;
    color:white ;

}
        .btn {
            background-color: #4CAF50;
            color: #fff;
            padding: 10px;
            border: none;
            cursor: pointer;
            width: 100%;
        }

        .btn:hover {
            background-color: #45a049;
        }

        .file-input {
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #2c2c2c;
            padding: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .file-input:hover {
            background-color: #3a3a3a;
        }

        .file-input input {
            display: none;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
        }
    </style>

<div class="container">
    <form method="post" enctype="multipart/form-data" class="game-form" id="gameForm">
        {% csrf_token %}

        <!-- Основные поля -->
        <div class="form-section">
            <div class="form-group">
                {{ form.name.label_tag }}
                {{ form.name }}
                {% if form.name.errors %}
                    <div class="error">{{ form.name.errors }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.category.label_tag }}
                <div class="select-wrapper">
                    {{ form.category }}
                </div>
                {% if form.category.errors %}
                    <div class="error">{{ form.category.errors }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.description.label_tag }}
                {{ form.description }}
                {% if form.description.errors %}
                    <div class="error">{{ form.description.errors }}</div>
                {% endif %}
            </div>
        </div>

        <!-- Медиа поля -->
        <div class="form-section">
            <div class="form-row">
                <div class="form-group">
                    {{ form.image.label_tag }}
                    {{ form.image }}
                    {% if form.image.errors %}
                        <div class="error">{{ form.image.errors }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ form.video.label_tag }}
                    {{ form.video }}
                    {% if form.video.errors %}
                        <div class="error">{{ form.video.errors }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Поле about -->
        <div class="form-section">
            <div class="form-group">
                {{ form.about.label_tag }}
                {{ form.about }}
                {% if form.about.errors %}
                    <div class="error">{{ form.about.errors }}</div>
                {% endif %}
            </div>
        </div>

        <!-- Поле status -->

            <div class="form-gup">
                <label for="id_status">Status <span class="required">*</span></label>
                <div class="sele">
                    {{ form.status }}
                </div>
                {% if form.status.errors %}
                    <div class="error">{{ form.status.errors }}</div>
                {% endif %}
                <div id="statusError" class="error" style="display:none;">Please select a status</div>
            </div>


        <!-- Дополнительные изображения -->
        <div class="form-section">
            <h3>Game Images</h3>
            {{ image_formset.management_form }}
            <div class="image-forms">
                {% for form in image_formset %}
                    <div class="form-group">
                        {{ form.image.label_tag }}
                        {{ form.image }}
                        {% if form.image.errors %}
                            <div class="error">{{ form.image.errors }}</div>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        </div>

        <!-- Кнопка отправки -->
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Save</button>
        </div>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
$(document).ready(function() {
    // Инициализация Select2 для поля категории
    $('#id_category').select2({
        placeholder: "Select category...",
        allowClear: true,
        width: '100%'
    });

    // Валидация формы
    $('#gameForm').on('submit', function(e) {
        if (!$('#id_status').val()) {
            e.preventDefault();
            $('#statusError').show();
            $('#id_status').addClass('is-invalid');
        }
    });

    // Скрываем ошибку при выборе статуса
    $('#id_status').change(function() {
        if ($(this).val()) {
            $('#statusError').hide();
            $(this).removeClass('is-invalid');
        }
    });
});
</script>

{% endblock %}
